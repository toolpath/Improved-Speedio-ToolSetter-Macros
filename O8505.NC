(FAST BREAK CHECK)
(PASS E VALUE FOR TOLERANCE)

#103=#8 (STORE THE PASSED TOLERANCE VALUE)
IF[#103EQ#0]GOTO3002 (IF NO TOLERANEC VALUE IS PASSED IN, ERROR)

G65 P8502 (CALL SETTINGS PROGRAM)
G65 P8503 T#3700 (CALL TOOL DATA PROGRAM)

IF[#107NE0]GOTO3003 (IF TOUCH DIAM IS NOT ZERO, ERROR)

#1=#[11000+#3700] (LENGTH OFFSET)
#1=#1+#[10000+#3700] (PLUS WEAR OFFSET)

M482 (TURN ON SETTER AIR BLAST)
G0 G90
G54.1 P48 (CALL UP A ZERO OFFSET, PROXY MACHINE COORDS)
G100 G49 T#3700 X#[#110] Y#[#110+1] Z[#[#110+2]+#1+#116] H00 (POSITION XYZ TO SETTER CAL POS PLUS TOOL LEN PLUS CLEARANCE)

(CENTER TOUCH)
G91 G31 Z-[#116-#113] F#111 (MOVE PAST CLEARANCE HEIGHT AT SEARCH FEED IN CASE OF TOOL PULL OUT)
#3004=2 (DISABLE FEED OVERRIDE)
G91 G131 Z-[#113*2] F#112 (FEED INTO SETTER FOR MEASUREMENT)
#13=#5063 (STORE THE Z SKIP POSITION)
M483 (TURN OFF SETTER AIR BLAST)
#3004=0(ENABLE FEED OVERRIDE AGAIN)
G91 G28 Z0 (RETRACT Z AXIS)
G90

(MATH)
#8=[#13-#[#110+2]]-#1 (ERROR OF MEASURED POSITION MINUS CAL VALUE MINUS TOOL LENGTH)
IF[#8GE#103]GOTO3000 (TOOL IS LONGER THAN ACCEPTABLE)
IF[#8LE-#103]GOTO3001 (TOOL IS SHORTER THAN ACCEPTABLE)
GOTO999

N3000
#3000=1 (TOOL PULL OUT)
N3001
#3000=1 (TOOL BROKEN)
N3002
#3000=1 (NO TOLERANCE VALUE PASSED)
N3003
#3000=1 (CANT BREAK CHECK OFFSET TOOLS)

N999
M99
